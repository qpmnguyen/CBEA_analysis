---
title: "Plotting"
author: "Quang Nguyen"
date: "10/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setting up packages  
```{r package_load}
library(tidyverse)
library(ggsci)
library(qs)
library(patchwork)
library(binom)
```

## Plotting  

```{r pwr_eval_new}
data <- qread("objects/pwr_sim/samp_eval_pwr.qs")
wc <- data$wc
stat <- data$sim
wc <- do.call(rbind,map(wc, as_tibble))
wc$adj <- rep(FALSE, nrow(wc))
wc$distr <- rep("Wilcoxon", nrow(wc))
wc$id <- unique(stat$id)
wc$spar <- stat$spar


stat <- stat %>% mutate(eval = map(eval, as_tibble)) %>% unnest(eval)
test <- right_join(stat, wc) 

ggplot(stat, aes(y = mean, x = spar)) + geom_point() + geom_line(aes(color = distr, linetype = adj)) + 
  facet_grid(eff_size ~ s_rho, scales = "free")
```

```{r fdr_eval_new}
data <- qread("objects/fdr_sim/samp_eval_fdr.qs")
wc <- data$wc
stat <- data$sim
wc <- do.call(rbind,map(wc, as_tibble))
wc$adj <- rep(FALSE, nrow(wc))
wc$distr <- rep("Wilcoxon", nrow(wc))
wc$id <- unique(stat$id)

left_join(stat, wc)


stat <- stat %>% mutate(eval = map(eval, as_tibble)) %>% unnest(eval)
ggplot(stat, aes(y = mean, x = spar)) + geom_point() + geom_line(aes(color = distr, linetype = adj)) + 
  facet_grid(eff_size ~ s_rho)
```

```{r auc_classifier}


```

```{r}
data <- readRDS(file = "objects/parameter_fit_correlation.rds")

ggplot(data, aes(x = s_rho, y = mean, col = distr, linetype = adj)) + geom_line() + geom_point() + scale_color_npg(labels = c("Mixture normal", "Normal")) +
    facet_grid(eval~., scales = "free_y") + theme_bw() +
    labs(x = "Inter-taxa correlation", y = "10% trimmed mean (10 repeats)", col = "Distribution", linetype = "Adjusted")


```